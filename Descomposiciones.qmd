---
title: "DescomposisioN_ cLASICA "
format: html
editor: visual
---

## Quarto

Quarto enables you to weave together content and executable code into a finished document. To learn more about Quarto see <https://quarto.org>.

```{r}
library(tidyverse)
library(fpp3)
```

```{r}
library(tsibble)

```

```{library(fpp3)}

```

vamos a importar los datos de las medicinas

```{r}
medicinas <- read_csv("medicinas.csv")
medicinas


```

tenemos que convertira a una 'tsible' de tibble las tisible

```{r}

medicinas <-  medicinas |>
  #agregamos con mutate otra columna 
  mutate(fecha=yearmonth(fecha))|>
   as_tsibble(index=fecha)
medicinas
```

```{r}
medicinas
```

Graficamos la serie

```{r}
medicinas |>
 autoplot(Cost)
```

Como habiamos visto, la serie tienen una tendencia a la alza y un fuerte patron estacional, entonces hacemos LA DESCOMPOSICION CLASSICA tal como lo hicimos en exel.

Aqui utilizando **model()** donde este nos va a permitir hacer varios modelos con esta funcion y su estructura es la siguiente

*model( nombre_variable= tipo de modelo a utilizar(Nombre variable y a graficar, type= tipo de serie multiplicativa o additiva))*

```{r}
 
# puedo correr linea por liena para saber que hace cada linea 
# descomponemos en descoposision clasica 

medicinas_dcmp <- medicinas |>
  #model entrena cualquier modelo de definiciones ( entrenar mas de un modelo a la ves)
                      #tipo de modelo su fincion (podemos utilizar con model muchos modelos)
                      # desoues ponemos la variable Y o la que quiero model (Cost),definir la descomposicion multiplicativa
  model(dcmp_clasica = classical_decomposition(Cost, type = "multiplicative")) |>
  components()

medicinas_dcmp

medicinas_dcmp |> 
  ggplot(aes(y = Cost, x = fecha)) +
  geom_line(color = "grey") +
  geom_line(aes(y = season_adjust), color = "blue")

medicinas_dcmp |> 
  autoplot()

```

Segundo ejemplo con dos modeloa calcular addtivo y multiplicativo

```{r}
model(dcmp_clasica = classical_decomposition(Cost, type = "multiplicative"),
      dcmp_classical_add= classical_decomposition((Cost, type= "additive"))) |>
  components()

medicinas_dcmp

medicinas_dcmp |> 
  ggplot(aes(y = Cost, x = fecha)) +
  geom_line(color = "green") +
  geom_line(aes(y = season_adjust), color = "blue")

medicinas_dcmp |> 
  autoplot()

```

```{r}

```
